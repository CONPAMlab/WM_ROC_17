if exist(['DataALSPara' '.mat'],'file') == 2 %DO NOT detect on 0 (not exist), only on re-run, the function can return 0 after delete the file. It's 7 within the same run.else	if isempty(RFile99)		RFile99 = 'Record_S1_b1';	end	ExtractProtc(RFile99,'',RMField);endload (['DataALSPara' '.mat']);AllFile = dir('*Record_*.mat');for i = 1: length(AllFile)	DataName = AllFile(i).name;		SubNum = DataName;	SubNum(findstr('_b',SubNum):end)=[];	SubNum(1:findstr('_S',SubNum)+1) = [];    SubNum(findstr('_',SubNum):end) = [];    	BlkNum=DataName;	BlkNum(1:findstr('_b',BlkNum)+1)=[];	BlkNum(findstr('.mat',BlkNum):end) = [];	SSNNum=DataName;	SSNNum(findstr('_b',SSNNum):end)=[];	SSNNum(1:findstr('_sn',SSNNum)+2) = [];        SubID = DataName;    SubID(findstr('_sn',SubID):end)=[];	SubID(1:findstr('_ID',SubID)) = [];        	if findstr(SSNNum,DataName) == 1		SSNNum = '1';	end		AllSSNBlk(i,:) = [str2num(SubNum) str2num(SSNNum) str2num(BlkNum)]; % subject, session number, block number     AllSubj(str2num(SubNum)).SubID =SubID;    AllSSStr{i}=SubNum;endAllSSNBlk %Sslists = unique(AllSSNBlk(:,1))';Sslists(ismember(Sslists,SsTossed)) = [];TtlSsRun = size(Sslists,2);% if ~isempty(SubNumber)% 	SubNow = Sslists(ismember(Sslists,SubNumber));% 	Sslists = SubNow;% 	TtlSsRun = size(Sslists,2);% endIfPlot=0;			  Factor_IdxAll={};Reslt_MeanAll=[];for i = 1 : TtlSsRun	Sslists(i)	if exist('Datastruct') == 1		clear Datastruct;	end	CrtSub = AllSSNBlk(AllSSNBlk(:,1) == Sslists(i),:);	SsnClted = setdiff(unique((CrtSub(:,2))),ExcldSSN);	SsnPerSub(i) = length(SsnClted);	SsnCltedXSub(i,1:SsnPerSub(i)) = SsnClted';		for j = 1: 1%SsnPerSub(i) 				BlkClted = setdiff(unique(CrtSub(CrtSub(:,2)==SsnClted(j),3)),ExcldBlk);		BlkPerSsnPerSub(i,j) = length(BlkClted);		DatastructALL = [];		% DataM1Freq = [];		for k = 1:size(CrtSub,1)%BlkPerSsnPerSub(i,j) 			if exist('Datastruct') == 1				clear Datastruct;			end            load( ['Record_S' num2str(CrtSub(1,1)) '_' AllSubj(CrtSub(1,1)).SubID '_sn' num2str(CrtSub(k,2)) '_b' num2str(CrtSub(k,3)) '.mat'])            disp(['Record_S' num2str(CrtSub(1,1)) '_' AllSubj(CrtSub(1,1)).SubID '_sn' num2str(CrtSub(k,2)) '_b' num2str(CrtSub(k,3)) '.mat'])			if ~isempty(RMField)				for Ri = 1 : length(RMField)					if isfield(Datastruct,RMField{Ri})			 			Datastruct = rmfield(Datastruct,RMField{Ri});					end				end							end						if (k == 1) && (j==1)				DatastructALL = Datastruct;			else				DatastructALL = [DatastructALL Datastruct];			end			        end    end    		bigMatrix = Struct2Array(DatastructALL);        	    %%%%----------------- compute results		% grouping variables		GrpCell={};		for g = 1: length(IdxFactors)			GrpCell = [GrpCell {bigMatrix(:,IdxFactors(g))}];		end		         [Factor_Idx,Reslt_Mean,Reslt_counts,Reslt_Lable] = DAS_General(bigMatrix(:,IdxDepen),GrpCell,[],{1-bigMatrix(:,IdxSign)},bigMatrix(:,IdxRT),'Cowan');        % grouping variables		GrpCell={};        IdxFactorsNow=[IdxFactors IdxSign];		for g = 1: length(IdxFactorsNow)			GrpCell = [GrpCell {bigMatrix(:,IdxFactorsNow(g))}];		end		        IdxDepen1=IdxDepen+1;         [Reslt_All1,Reslt_Mean1, Reslt_Sem1, Reslt_Counts1, Reslt_Idx1] = grpstatsWW(bigMatrix(:,IdxDepen1),GrpCell);         [Myhistc, myBin] = histc(Reslt_All1,[1:1:6],2);            % %     '1'    '0'    '16'            % %     '1'    '0'    '48'            % %     '1'    '1'    '16'            % %     '1'    '1'    '48'            % %     '3'    '0'    '16'            % %     '3'    '0'    '48'            % %     '3'    '1'    '16'            % %     '3'    '1'    '48'            % %     '6'    '0'    '16'            % %     '6'    '0'    '48'            % %     '6'    '1'    '16'            % %     '6'    '1'    '48'            % % set size; sameness (0: change); CM%             MyGrp=[1 3;2 4;5 7;6 8;9 11;10 12];%column:change, same             % '1'    '6'    '16'    '0'            % '1'    '6'    '16'    '1'            % '1'    '6'    '48'    '0'            % '1'    '6'    '48'    '1'            % '2'    '6'    '16'    '0'            % '2'    '6'    '16'    '1'            % '2'    '6'    '48'    '0'            % '2'    '6'    '48'    '1'%     col 1:     [1 2];  % single probe, whole display%     col 2: SS%     Col 3: CM%     col 4: sameness (1: same, treated as signal for sameness task)%          MyGrp=[1 3;2 4;5 7;6 8;9 11;10 12];        CntAllNow=sum(Myhistc,3);        nPOint = size(CntAllNow,2);        for j = 1: size(CntAllNow,1)/2%             FA_Hit_all(:,:,j)=[CntAllNow((j-1)*2+2,:);CntAllNow((j-1)*2+1,:)];%             if j <= 2%                  FA_Hit_all(:,:,j)=[CntAllNow((j-1)*2+2,:);CntAllNow((j-1)*2+1,:)];%             else%                  FA_Hit_all(:,:,j)=[CntAllNow((j-1)*2+1,:);CntAllNow((j-1)*2+2,:)];%             end             FA_Hit_all(:,:,j)=[CntAllNow((j-1)*2+1,nPOint:-1:1);CntAllNow((j-1)*2+2,nPOint:-1:1)];            FA_Hit_all_XSubj(:,:,j,i)=[CntAllNow((j-1)*2+1,nPOint:-1:1);CntAllNow((j-1)*2+2,nPOint:-1:1)];            [ROCNow, zROC] = CompROCs(FA_Hit_all(:,:,j),IfPlot);            ROC_all(:,:,j)=ROCNow;            zROC_all(:,:,j)=zROC;        end        a=FA_Hit_all(:,:,1)        % index of   ROC_all               Idx_RocAll = Reslt_Idx1(1:2:end,:);        %     '1'    '3'    '16'        %     '1'    '3'    '48'        %     '1'    '6'    '16'        %     '1'    '6'    '48'        %     '2'    '3'    '16'        %     '2'    '3'    '48'        %     '2'    '6'    '16'        %     '2'    '6'    '48'            ROC_allxSubj(:,:,:,i)=ROC_all;        zROC_allxSubj(:,:,:,i)=zROC_all;                if IndvPlot == 1            figure(i)            for j = 1: size(ROC_all,3)%                 subplot(1,size(ROC_all,3),j)                hold on                plot(ROC_all(1,:,j),ROC_all(2,:,j),[MyCOlor{j}])%                 plot(ROC_all(1,:,j+2),ROC_all(2,:,j+2),'ro-')                hold off                axis([0 1 0 1])                       set(gca,'box','on')                set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])                axis square                %                 title(['ss=' Idx_RocAll{j,2} '; CM=' Idx_RocAll{j,3}])            end            hold on            plot([0 1], [0 1],'k-')                        hold off            legend(Mylegend,'location','southeast')        end        set(gcf,'name',num2str(Sslists(i)))            % 		[Factor_Idx,Reslt_Mean,Reslt_counts,Reslt_Lable] = DAS_General(bigMatrix(:,IdxDepen),GrpCell,[],{1-bigMatrix(:,IdxSign),bigMatrix(:,4),'Cowan'});% 		if IndvPlot == 1% 			szFactor_Idx= size(Factor_Idx);% 			if IndPlotStay == 1% 				figure;% 			end% 			% 			plotData(reshape(str2num(char(Factor_Idx)),szFactor_Idx(1),szFactor_Idx(2)),Reslt_Mean(:,1),LIdxFactors',Reslt_Lable(1),(['subject ' num2str(Sslists(i))]),PlotScale);% 		end				% 		Factor_IdxAll=[Factor_IdxAll; [repmat({num2str(Sslists(i))},length(Reslt_Mean),1) repmat({num2str(SsnClted(j))},length(Reslt_Mean),1) Factor_Idx]];		Reslt_MeanAll = [Reslt_MeanAll;Reslt_Mean];			FactorIn =[{'SS'} {'test'}];		Reslt_LableAll = [{'Subject'} {'session'} LIdxFactors' Reslt_Lable];		Reslt_MeanAllXSub(:,:,i)=  Reslt_Mean;		    endsave all.mat%%% BFactor = [1 2];  % single probe, whole displayROC_allxSubjMean=mean(ROC_allxSubj,4);figure(i+1)set(gcf,'position', [680 645 633 455])set(gcf,'PaperPositionMode','auto');for j = 1: size(ROC_all,3)%     subplot(1,size(ROC_all,3),j)    hold on    plot(ROC_allxSubjMean(1,:,j),ROC_allxSubjMean(2,:,j),[MyCOlor{j}])    hold off    axis([0 1 0 1])           set(gca,'box','on')    set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])    axis squareendhold onplot([0 1], [0 1],'k-')hold offlegend(Mylegend,'location','southeast')print(gcf,'-dpdf','GrandAVG')%%Dowhat=[1 1 1 1 0 0 0 1];IfPlot=0;Roc2Fit = ROC_allxSubj(:,:,1,1);StartGuess=[zeros(1,size(Roc2Fit,2))+0.2 0.54 0.3];% MyCOlor={'r','g','b','m','c','y'};MyLine={'-','--',':','-.'};MySymbol={'*','o','*','o','*','o'};% Mylegend={'circled','non-circled'}; ExpNameNow = 'Ori_circle';FigureNUm = TtlSsRun+2;MylegendCond=Mylegend;%{'change','sameness'}; PlotFName='test';figure(FigureNUm)set(gcf,'position',[510 558 287 429]);    for j = 1: size(ROC_allxSubj,3)        subplot(2,size(ROC_allxSubj,3)/2,j)        hold on        plot(squeeze(ROC_allxSubj(1,:,j,:)),squeeze(ROC_allxSubj(2,:,j,:)))                plot(mean(squeeze(ROC_allxSubj(1,:,j,:)),2),mean(squeeze(ROC_allxSubj(2,:,j,:)),2),'ko-','LineWidth',2,...                       'MarkerEdgeColor','k',...                       'MarkerSize',6)%                        'MarkerFaceColor','g',...%         plot(ROC_all(1,:,j+2),ROC_all(2,:,j+2),'ro-')        plot([0 1],[0 1],'k-');             axis([0 1 0 1])              axis square%         axis equal        set(gca,'box','on')        set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])        hold off%         title(MylegendCond{j})    endprint(gcf,'-dpdf','-r300',[ExpNameNow '_RawRocAllSubjs.pdf'])%%for i = 1: size(ROC_allxSubj,4) % subjects    for j = 1: size(ROC_allxSubj,3)        [OutFit,hdlcfg,ROC_TheoNow,zROC_TheoNow, Fitted] = FitROCsXModels(ROC_allxSubj(:,:,j,i),IfPlot,StartGuess,Dowhat,PlotFName);        ROC_TheoNowAllSubj(:,:,:,j,i)=ROC_TheoNow;        zROC_TheoNowAllSubj(:,:,:,j,i)=zROC_TheoNow;        Fitted_allSubj(j,i).Rst = Fitted;                DPSD_allSubj(:,j,i) = Fitted_allSubj(j,i).Rst(3).Rst;        Slot_allSubj(:,j,i) = Fitted_allSubj(j,i).Rst(4).Rst;    endend%    disp('main effects for d prime')    SDMean=DPSD_allSubj(1,:,:);    [GrpI,GrpJ,GrpS]=ind2sub(size(SDMean),[1:numel(SDMean)]);    stats = rm_anova2(reshape(SDMean,[1,numel(SDMean)]),GrpS,GrpI,GrpJ,{LIdxFactors{1},LIdxFactors{1}});    if ~isnan(stats{2,6}), disp(['main effect of ' stats{2,1} ': ' '[F(' num2str(stats{2,3}) ',' num2str(stats{5,3}) ')='  num2str(stats{2,5})  ', p=' sprintf('%5.3f',stats{2,6}) ', pEta=' sprintf('%5.3f',stats{2,7}) ']']);end    if ~isnan(stats{3,6}), disp(['main effect of ' stats{3,1} ': ' '[F(' num2str(stats{3,3}) ',' num2str(stats{6,3}) ')='  num2str(stats{3,5})  ', p=' sprintf('%5.3f',stats{3,6}) ', pEta=' sprintf('%5.3f',stats{3,7}) ']']);end    if ~isnan(stats{4,6}), disp(['interaction of ' stats{4,1} ': ' '[F(' num2str(stats{4,3}) ',' num2str(stats{7,3}) ')='  num2str(stats{4,5})  ', p=' sprintf('%5.3f',stats{4,6}) ', pEta=' sprintf('%5.3f',stats{4,7}) ']']);end    CI95_DPSD(:,1)= Cousineau_CI(squeeze(SDMean));            disp('main effects for Ro')    SDMean=DPSD_allSubj(2,:,:);    [GrpI,GrpJ,GrpS]=ind2sub(size(SDMean),[1:numel(SDMean)]);    stats = rm_anova2(reshape(SDMean,[1,numel(SDMean)]),GrpS,GrpI,GrpJ,{LIdxFactors{1},LIdxFactors{1}});    if ~isnan(stats{2,6}), disp(['main effect of ' stats{2,1} ': ' '[F(' num2str(stats{2,3}) ',' num2str(stats{5,3}) ')='  num2str(stats{2,5})  ', p=' sprintf('%5.3f',stats{2,6}) ', pEta=' sprintf('%5.3f',stats{2,7}) ']']);end    if ~isnan(stats{3,6}), disp(['main effect of ' stats{3,1} ': ' '[F(' num2str(stats{3,3}) ',' num2str(stats{6,3}) ')='  num2str(stats{3,5})  ', p=' sprintf('%5.3f',stats{3,6}) ', pEta=' sprintf('%5.3f',stats{3,7}) ']']);end    if ~isnan(stats{4,6}), disp(['interaction of ' stats{4,1} ': ' '[F(' num2str(stats{4,3}) ',' num2str(stats{7,3}) ')='  num2str(stats{4,5})  ', p=' sprintf('%5.3f',stats{4,6}) ', pEta=' sprintf('%5.3f',stats{4,7}) ']']);end    CI95_DPSD(:,2)= Cousineau_CI(squeeze(SDMean));    disp('main effects for Rn')    SDMean=DPSD_allSubj(3,:,:);    [GrpI,GrpJ,GrpS]=ind2sub(size(SDMean),[1:numel(SDMean)]);    stats = rm_anova2(reshape(SDMean,[1,numel(SDMean)]),GrpS,GrpI,GrpJ,{LIdxFactors{1},LIdxFactors{1}});    if ~isnan(stats{2,6}), disp(['main effect of ' stats{2,1} ': ' '[F(' num2str(stats{2,3}) ',' num2str(stats{5,3}) ')='  num2str(stats{2,5})  ', p=' sprintf('%5.3f',stats{2,6}) ', pEta=' sprintf('%5.3f',stats{2,7}) ']']);end    if ~isnan(stats{3,6}), disp(['main effect of ' stats{3,1} ': ' '[F(' num2str(stats{3,3}) ',' num2str(stats{6,3}) ')='  num2str(stats{3,5})  ', p=' sprintf('%5.3f',stats{3,6}) ', pEta=' sprintf('%5.3f',stats{3,7}) ']']);end    if ~isnan(stats{4,6}), disp(['interaction of ' stats{4,1} ': ' '[F(' num2str(stats{4,3}) ',' num2str(stats{7,3}) ')='  num2str(stats{4,5})  ', p=' sprintf('%5.3f',stats{4,6}) ', pEta=' sprintf('%5.3f',stats{4,7}) ']']);end    CI95_DPSD(:,3)= Cousineau_CI(squeeze(SDMean));    figure(FigureNUm+101)    barweb(mean(DPSD_allSubj,3), CI95_DPSD', [], {'d prime','Ro','Rn'}, [], 'DPSD param', [], [], [], Mylegend);    print(gcf,'-dpdf',[ExpNameNow '_MeanFits.pdf'])%% fits of aggragated data % FitSubjTakSSCM=[1,4];% Roc2Fit = ROC_allxSubj(:,:,FitSubjTakSSCM(2),FitSubjTakSSCM(1));% PlotFName=(['subject # ' num2str(FitSubjTakSSCM(1)) ', task=' Idx_RocAll{FitSubjTakSSCM(2),1} ', SS=' Idx_RocAll{FitSubjTakSSCM(2),2} ', CM=' Idx_RocAll{FitSubjTakSSCM(2),3}]);% disp(PlotFName)FitSubjTakSSCM=[1,1];Roc2Fit_all = mean(ROC_allxSubj,4);figure(FigureNUm+2)set(gcf,'position',[182 490 1213 435]);set(gcf,'PaperOrientation','landscape');for i = 1: 1 % mean across subjects    ROC_all=Roc2Fit_all;    for j = 1: size(ROC_allxSubj,3)        subplot(1,size(ROC_allxSubj,3)+1,j)        hold on        plot(ROC_all(1,:,j),ROC_all(2,:,j),['k' MySymbol{j} '-'])        plot([0 1],[0 1],'k-');             axis([0 1 0 1])              axis square%         axis equal        set(gca,'box','on')        set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])        hold off%         title(MylegendCond{j})        subplot(1,size(ROC_allxSubj,3)+1,size(ROC_allxSubj,3)+1)        hold on        plot(ROC_all(1,:,j),ROC_all(2,:,j),[MyCOlor{j} MySymbol{j} '-'])        hold  off    end    subplot(1,size(ROC_allxSubj,3)+1,size(ROC_allxSubj,3)+1)    hold on    plot([0 1],[0 1],'k-');         axis([0 1 0 1])          axis square    set(gca,'box','on')    set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])%     h=legend(MylegendCond,'Location','SouthEast');%     set(h, 'Box', 'off','FontSize',8)    hold  offend% PlotFName=(['subject all Mean,  task=' Idx_RocAll{FitSubjTakSSCM(2),1} ', SS=' Idx_RocAll{FitSubjTakSSCM(2),2} ', CM=' Idx_RocAll{FitSubjTakSSCM(2),3}]);% disp(PlotFName)IfPlot=0;clear ROC_TheoNow zROC_TheoNow ROC_TheoNowAll zROC_TheoNowAllfor j = 1: size(Roc2Fit_all,3)    Roc2Fit = Roc2Fit_all(:,:,j);    [OutFit,hdlcfg,ROC_TheoNow,zROC_TheoNow, Fitted] = FitROCsXModels(Roc2Fit,IfPlot,StartGuess,Dowhat,PlotFName);    ROC_TheoNowAll(:,:,:,j)=ROC_TheoNow;    zROC_TheoNowAll(:,:,:,j)=zROC_TheoNow;    Fitted_all(j).Rst = Fitted;end%%% MyTask={'SP/change','WD/same'};MylegendModels={'data', 'HLT','UVSD','DPSD','Slot','','','','DPSDRn'}; figure(FigureNUm+1)set(gcf,'position',[473 465 982 512]);for j = 1: size(Roc2Fit_all,3)    subplot(2,size(Roc2Fit_all,3)/2,j)    hold on    plot(ROC_all(1,:,j),ROC_all(2,:,j),'ko')%     plot(ROC_all(1,:,j+4),ROC_all(2,:,j+4),'ro')        for k = 1: 4        plot(ROC_TheoNowAll(1,:,k,j),ROC_TheoNowAll(2,:,k,j),[MyCOlor{k}  MyLine{1}],'LineWidth',1)    end%     plot(ROC_TheoNowAll(1,:,j+4),ROC_TheoNowAll(2,:,j+4))    plot([0 1],[0 1],'k-');         axis([0 1 0 1])          axis square    set(gca,'box','on')    set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])    hold off%     title(MylegendCond{j})%     title({['task=' MyTask{ceil(j/2)}], ['ss=' Idx_RocAll{j,2} '; CM=' Idx_RocAll{j,3}]})     if j == size(Roc2Fit_all,3)          legend(MylegendModels([1:size(ROC_TheoNowAll,3)+1]),'Location','SouthEast')     endendfor whichmodel = 1: 4    Fitted_all(1).Rst(whichmodel), Fitted_all(2).Rst(whichmodel)end% DPSD fitsMylegendModels={'data', 'DPSD'}; titleNow = Mylegend;%{'circled','non-circled'}figure(FigureNUm+3)set(gcf,'position',[473 465 982 512]);for j = 1: size(Roc2Fit_all,3)    subplot(size(Roc2Fit_all,3)/2,2,j)    hold on    plot(ROC_all(1,:,j),ROC_all(2,:,j),'ko')%     plot(ROC_all(1,:,j+4),ROC_all(2,:,j+4),'ro')        for k = 3: 3        plot(ROC_TheoNowAll(1,:,k,j),ROC_TheoNowAll(2,:,k,j),[MyCOlor{k}  MyLine{1}],'LineWidth',1)    end    %     plot(ROC_TheoNowAll(1,:,j+4),ROC_TheoNowAll(2,:,j+4))    plot([0 1],[0 1],'k-');         axis([0 1 0 1])          axis square    set(gca,'box','on')    set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])    hold off    FitDPSDNow = Fitted_all(j).Rst(3).Rst;    titleNowPlot{1} = titleNow{j};    titleNowPlot{2} = ['d prime=' num2str(FitDPSDNow(1),'%7.2f') ', Ro=' num2str(FitDPSDNow(2),'%7.2f') ' Rn=' num2str(FitDPSDNow(3),'%7.2f')]    title( titleNowPlot )%     title(MylegendCond{j})%     title({['task=' MyTask{ceil(j/2)}], ['ss=' Idx_RocAll{j,2} '; CM=' Idx_RocAll{j,3}]})     if j == size(Roc2Fit_all,3)          legend(MylegendModels,'Location','SouthEast')     endend% SLOT fitsMylegendModels={'data', 'SLOT'}; titleNow = Mylegend;figure(FigureNUm+4)set(gcf,'position',[473 465 982 512]);for j = 1: size(Roc2Fit_all,3)    subplot(size(Roc2Fit_all,3)/2,2,j)    hold on    plot(ROC_all(1,:,j),ROC_all(2,:,j),'ko')%     plot(ROC_all(1,:,j+4),ROC_all(2,:,j+4),'ro')        for k = 4: 4        plot(ROC_TheoNowAll(1,:,k,j),ROC_TheoNowAll(2,:,k,j),[MyCOlor{k}  MyLine{1}],'LineWidth',1)    end    %     plot(ROC_TheoNowAll(1,:,j+4),ROC_TheoNowAll(2,:,j+4))    plot([0 1],[0 1],'k-');         axis([0 1 0 1])          axis square    set(gca,'box','on')    set(gca,'xtick',[0 0.5 1],'ytick',[0 0.5 1])    hold off    FitDPSDNow = Fitted_all(j).Rst(4).Rst;    titleNowPlot{1} = titleNow{j};    titleNowPlot{2} = ['d prime=' num2str(FitDPSDNow(1),'%7.2f') ', Pm=' num2str(FitDPSDNow(2),'%7.2f') ]    title( titleNowPlot )%     title(MylegendCond{j})%     title({['task=' MyTask{ceil(j/2)}], ['ss=' Idx_RocAll{j,2} '; CM=' Idx_RocAll{j,3}]})     if j == size(Roc2Fit_all,3)          legend(MylegendModels,'Location','SouthEast')     end     endfigure(FigureNUm+2)print(gcf,'-dpdf',[ExpNameNow '_rawMean.pdf'])figure(FigureNUm)print(gcf,'-dpdf',[ExpNameNow '_raw.pdf'])figure(FigureNUm+1)print(gcf,'-dpdf',[ExpNameNow '_fit.pdf'])figure(FigureNUm+3)print(gcf,'-dpdf',[ExpNameNow '_DPSDOnly.pdf'])figure(FigureNUm+4)print(gcf,'-dpdf',[ExpNameNow '_SlotOnly.pdf'])